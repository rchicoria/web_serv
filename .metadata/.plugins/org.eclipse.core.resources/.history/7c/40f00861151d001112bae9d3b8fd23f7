<?xml version="1.0" encoding="UTF-8"?>

<process-definition xmlns="urn:jbpm.org:jpdl-3.2"
 name="login">
 <start-state name="start">
  <transition name="to_state" to="Login">
   <action name="action" class="com.sample.action.MessageActionHandler">
    <message>Going to the ESB STATE!</message>
   </action>
  </transition>
 </start-state>
 
 <node name="Login">
  <action name="esbAction"
   class="org.jboss.soa.esb.services.jbpm.actionhandlers.EsbActionHandler">
   <esbCategoryName>
    Authentications
   </esbCategoryName>
   <esbServiceName>PhasebookESB</esbServiceName>
   <bpmToEsbVars>
    <mapping bpm="data" esb="username" />
    <mapping bpm="password" esb="password" />
    <mapping bpm="theBody" esb="BODY_CONTENT"/>
   </bpmToEsbVars>
   <esbToBpmVars>
    <mapping esb="send" bpm="data" />
   </esbToBpmVars>
  </action>
  <transition name="to_end" to="end">
  </transition>
 </node>

 <end-state name="end">
  <event type="node-enter">
   <action name="action" class="com.sample.action.MessageActionHandler2">
   </action>
  </event>
 </end-state>

</process-definition>